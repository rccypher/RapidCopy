<div class="file" [class.selected]="file.isSelected" #fileElement>
    <div class="content">
        <div class="status">
            <img src="assets/icons/default-remote.svg" id="default-remote"
                 *ngIf="file.status === ViewFile.Status.DEFAULT && file.remoteSize > 0" />
            <img src="assets/icons/default-local.svg" id="default-local"
                 *ngIf="file.status === ViewFile.Status.DEFAULT && file.remoteSize === 0 && file.localSize > 0" />
            <img src="assets/icons/queued.svg" id="queued"
                 *ngIf="file.status === ViewFile.Status.QUEUED" />
            <img src="assets/icons/downloading.svg" id="downloading"
                 *ngIf="file.status === ViewFile.Status.DOWNLOADING" />
            <img src="assets/icons/downloaded.svg" id="downloaded"
                 *ngIf="file.status === ViewFile.Status.DOWNLOADED" />
            <img src="assets/icons/stopped.svg" id="stopped"
                 *ngIf="file.status === ViewFile.Status.STOPPED" />
            <img src="assets/icons/deleted.svg" id="deleted"
                 *ngIf="file.status === ViewFile.Status.DELETED" />
            <img src="assets/icons/extracting.svg" id="extracting"
                 *ngIf="file.status === ViewFile.Status.EXTRACTING" />
            <img src="assets/icons/extracted.svg" id="extracted"
                 *ngIf="file.status === ViewFile.Status.EXTRACTED" />
            <img src="assets/icons/validating.svg" id="validating"
                 *ngIf="file.status === ViewFile.Status.VALIDATING" />
            <img src="assets/icons/validated.svg" id="validated"
                 *ngIf="file.status === ViewFile.Status.VALIDATED" />
            <img src="assets/icons/corrupt.svg" id="corrupt"
                 *ngIf="file.status === ViewFile.Status.CORRUPT" />
            <!-- don't show text for default status, except local-only files -->
            <span *ngIf="file.status != ViewFile.Status.DEFAULT"
                  class="text">{{file.status | capitalize}}</span>
            <span *ngIf="file.status === ViewFile.Status.DEFAULT && file.remoteSize === 0 && file.localSize > 0"
                  class="text">Local Only</span>
        </div>
        <div class="name">
            <img src="assets/icons/file-light.svg" *ngIf="!file.isDir && !file.isArchive" />
            <img src="assets/icons/file-archive-light.svg" *ngIf="!file.isDir && file.isArchive" />
            <img src="assets/icons/directory-light.svg" *ngIf="file.isDir && !file.isArchive" />
            <img src="assets/icons/directory-archive-light.svg" *ngIf="file.isDir && file.isArchive" />
            <div class="text">
                <div class="title">
                    {{file.name}}
                    <span class="path-pair-badge" *ngIf="file.pathPairName">{{file.pathPairName}}</span>
                </div>
                <div class="details" *ngIf="(options | async)?.showDetails">
                    <div class="details-text">
                        Remote File<br />
                        <span class="tab"></span>Created:
                            {{(file.remoteCreatedTimestamp | date: 'EEE, MMM d yyyy, h:mm:ss a') ||
                               "Not Available"}}<br />
                        <span class="tab"></span>Modified:
                            {{(file.remoteModifiedTimestamp | date: 'EEE, MMM d yyyy, h:mm:ss a') ||
                               "Not Available"}}<br />
                        Local File <br />
                        <span class="tab"></span>Created:
                            {{(file.localCreatedTimestamp | date: 'EEE, MMM d yyyy, h:mm:ss a') ||
                               "Not Available"}}<br />
                        <span class="tab"></span>Modified:
                            {{(file.localModifiedTimestamp | date: 'EEE, MMM d yyyy, h:mm:ss a') ||
                               "Not Available"}}
                    </div>
                </div>
            </div>
        </div>
        <div class="speed">
            <span *ngIf="file.downloadingSpeed">{{file.downloadingSpeed | fileSize:3}}/s</span>
            <!-- for mobile layout -->
            <div class="speed-eta">
                <span *ngIf="file.status === ViewFile.Status.DOWNLOADING">eta: {{file.eta | eta}}</span>
            </div>
        </div>
        <!-- for desktop layout -->
        <div class="eta">
            <span *ngIf="file.status === ViewFile.Status.DOWNLOADING">{{file.eta | eta}}</span>
        </div>
        <div class="size">
            <div class="progress">
                <div class="progress-bar" role="progressbar"
                     [class.progress-bar-animated]="
                        file.status === ViewFile.Status.DOWNLOADING ||
                        file.status === ViewFile.Status.EXTRACTING
                     "
                     [class.progress-bar-striped]="
                        file.status === ViewFile.Status.DOWNLOADING ||
                        file.status === ViewFile.Status.EXTRACTING
                     "
                     [attr.aria-valuenow]="file.percentDownloaded" aria-valuemin="0" aria-valuemax="100"
                     [style.width]="
                        min(file.percentDownloaded,100) + '%'
                     ">
                    {{min(file.percentDownloaded, 100)}}%
                </div>
            </div>
            <div class="size_info">
                {{file.localSize | fileSize:3}} of {{file.remoteSize | fileSize:3}}
            </div>
        </div>
    </div>

    <!-- actions div, visible on selection -->
    <div class="actions">
        <div class="button" appClickStopPropagation
             [attr.disabled]="isQueueable() ? null : true"
             [title]="isQueueable() ? 'Queue for download' : 'Cannot queue: ' + file.status"
             (click)="!isQueueable() || onQueue(file)"
             [class.loading]="activeAction == FileAction.QUEUE">
            <div class="loader"></div>
            <img src="assets/icons/queue.svg" />
            <div class="text"><span>Queue</span></div>
        </div>
        <div class="button" appClickStopPropagation
             [attr.disabled]="isStoppable() ? null : true"
             [title]="isStoppable() ? 'Stop download' : 'No active download to stop'"
             (click)="!isStoppable() || onStop(file)"
             [class.loading]="activeAction == FileAction.STOP">
            <div class="loader"></div>
            <img src="assets/icons/stop.svg" />
            <div class="text"><span>Stop</span></div>
        </div>
        <div class="button" appClickStopPropagation
             [attr.disabled]="isExtractable() ? null : true"
             [title]="isExtractable() ? 'Extract archive' : (!file.isArchive ? 'Not an archive' : 'Cannot extract: ' + file.status)"
             (click)="!isExtractable() || onExtract(file)"
             [class.loading]="activeAction == FileAction.EXTRACT">
            <div class="loader"></div>
            <img src="assets/icons/extract.svg" />
            <div class="text"><span>Extract</span></div>
        </div>
        <div class="button" appClickStopPropagation
             [attr.disabled]="isLocallyDeletable() ? null : true"
             [title]="isLocallyDeletable() ? 'Delete local copy' : 'No local copy to delete'"
             (click)="!isLocallyDeletable() || onDeleteLocal(file)"
             [class.loading]="activeAction == FileAction.DELETE_LOCAL">
            <div class="loader"></div>
            <img src="assets/icons/delete-local.svg" />
            <div class="text"><span>Delete Local</span></div>
        </div>
        <div class="button" appClickStopPropagation
             [attr.disabled]="isRemotelyDeletable() ? null : true"
             [title]="isRemotelyDeletable() ? 'Delete from remote server' : 'Cannot delete: ' + file.status"
             (click)="!isRemotelyDeletable() || onDeleteRemote(file)"
             [class.loading]="activeAction == FileAction.DELETE_REMOTE">
            <div class="loader"></div>
            <img src="assets/icons/delete-remote.svg" />
            <div class="text"><span>Delete Remote</span></div>
        </div>
        <div class="button" appClickStopPropagation
             [attr.disabled]="isValidatable() ? null : true"
             [title]="isValidatable() ? 'Run integrity validation' : 'Cannot validate: ' + file.status"
             (click)="!isValidatable() || onValidate(file)"
             [class.loading]="activeAction == FileAction.VALIDATE">
            <div class="loader"></div>
            <img src="assets/icons/validate.svg" />
            <div class="text"><span>Validate</span></div>
        </div>
    </div>
</div>
